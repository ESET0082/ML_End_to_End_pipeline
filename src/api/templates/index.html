<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Meter Units Consumption Prediction</title>
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background: #f3f4f6;
            color: #111827;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
        }

        .page {
            width: 100%;
            max-width: 960px;
            padding: 24px;
        }

        .card {
            background: #ffffff;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(15, 23, 42, 0.08);
            padding: 24px 24px 20px;
            display: grid;
            grid-template-columns: minmax(0, 1.1fr) minmax(0, 1fr);
            gap: 24px;
        }

        @media (max-width: 820px) {
            .card {
                grid-template-columns: 1fr;
            }
        }

        .header {
            margin-bottom: 16px;
        }

        .title {
            margin: 0;
            font-size: 1.6rem;
            font-weight: 600;
        }

        form {
            margin-top: 8px;
        }

        .field-grid {
            display: grid;
            grid-template-columns: repeat(2, minmax(0, 1fr));
            gap: 12px 16px;
        }

        @media (max-width: 600px) {
            .field-grid {
                grid-template-columns: 1fr;
            }
        }

        .field {
            display: flex;
            flex-direction: column;
            font-size: 0.85rem;
        }

        .field label {
            margin-bottom: 4px;
            color: #374151;
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            gap: 8px;
        }

        .range-note {
            font-size: 0.75rem;
            color: #9ca3af;
            font-weight: normal;
        }

        input,
        select {
            padding: 7px 9px;
            border-radius: 8px;
            border: 1px solid #d1d5db;
            background: #f9fafb;
            color: #111827;
            font-size: 0.9rem;
            outline: none;
            transition: border-color 0.12s ease, background 0.12s ease;
        }

        input:focus,
        select:focus {
            border-color: #2563eb;
            background: #ffffff;
        }

        input::placeholder {
            color: #9ca3af;
        }

        .actions {
            margin-top: 16px;
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        button {
            border: none;
            border-radius: 999px;
            padding: 8px 18px;
            font-size: 0.9rem;
            font-weight: 600;
            letter-spacing: 0.03em;
            text-transform: uppercase;
            cursor: pointer;
            background: #2563eb;
            color: #ffffff;
            transition: background 0.12s ease, transform 0.08s ease,
                        box-shadow 0.08s ease;
            box-shadow: 0 8px 18px rgba(37, 99, 235, 0.25);
        }

        button:hover {
            background: #1d4ed8;
            transform: translateY(-1px);
            box-shadow: 0 10px 22px rgba(37, 99, 235, 0.28);
        }

        button:active {
            transform: translateY(0);
            box-shadow: 0 5px 12px rgba(15, 23, 42, 0.18);
        }

        .result-panel {
            border-radius: 10px;
            border: 1px solid #e5e7eb;
            padding: 14px 14px 12px;
            background: #f9fafb;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .result-header {
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.12em;
            color: #6b7280;
        }

        #resultText {
            margin: 0;
            font-size: 0.95rem;
            color: #111827;
        }

        #probText {
            margin: 0;
            font-size: 0.85rem;
            color: #4b5563;
        }

        .status-pill {
            align-self: flex-start;
            padding: 3px 9px 4px;
            border-radius: 999px;
            font-size: 0.75rem;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            font-weight: 600;
        }

        .status-neutral {
            background: #e5e7eb;
            color: #4b5563;
        }

        .status-good {
            background: #dcfce7;
            color: #166534;
        }

        .status-warning {
            background: #fef3c7;
            color: #92400e;
        }

        .status-high {
            background: #fee2e2;
            color: #b91c1c;
        }

        .info-box {
            border-radius: 10px;
            border: 1px solid #e5e7eb;
            padding: 12px 12px 10px;
            background: #f9fafb;
            font-size: 0.8rem;
            color: #6b7280;
            line-height: 1.4;
        }

        .right-column {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .small-muted {
            font-size: 0.75rem;
            color: #9ca3af;
        }
    </style>
</head>
<body>
<div class="page">
    <div class="card">
        <!-- Left: Form -->
        <div>
            <div class="header">
                <h1 class="title">Meter Units Prediction</h1>
            </div>

            <form id="predictionForm">
                <div class="field-grid">
                    <div class="field">
                        <label for="voltage">
                            <span>Voltage (V)</span>
                            <span class="range-note">180–250</span>
                        </label>
                        <input
                            type="number"
                            step="0.01"
                            id="voltage"
                            placeholder="e.g. 220.5"
                            value="220.5"
                            min="180"
                            max="250"
                            required
                        >
                    </div>

                    <div class="field">
                        <label for="temperature">
                            <span>Temperature (°C)</span>
                            <span class="range-note">0–50</span>
                        </label>
                        <input
                            type="number"
                            step="0.1"
                            id="temperature"
                            placeholder="e.g. 25.0"
                            value="25.0"
                            min="0"
                            max="50"
                            required
                        >
                    </div>

                    <div class="field">
                        <label for="power_factor">
                            <span>Power Factor</span>
                            <span class="range-note">0.7–1.0</span>
                        </label>
                        <input
                            type="number"
                            step="0.01"
                            id="power_factor"
                            placeholder="e.g. 0.95"
                            value="0.95"
                            min="0.7"
                            max="1.0"
                            required
                        >
                    </div>

                    <div class="field">
                        <label for="load_kw">
                            <span>Load (kW)</span>
                            <span class="range-note">0–5.0</span>
                        </label>
                        <input
                            type="number"
                            step="0.1"
                            id="load_kw"
                            placeholder="e.g. 2.5"
                            value="2.5"
                            min="0"
                            max="5.0"
                            required
                        >
                    </div>

                    <div class="field">
                        <label for="frequency_hz">
                            <span>Frequency (Hz)</span>
                            <span class="range-note">49–51</span>
                        </label>
                        <input
                            type="number"
                            step="0.01"
                            id="frequency_hz"
                            placeholder="e.g. 50.0"
                            value="50.0"
                            min="49"
                            max="51"
                            required
                        >
                    </div>

                    <div class="field">
                        <label for="hour">
                            <span>Hour (0–23)</span>
                            <span class="range-note">Time of day</span>
                        </label>
                        <input
                            type="number"
                            step="1"
                            id="hour"
                            placeholder="e.g. 12"
                            value="12"
                            min="0"
                            max="23"
                            required
                        >
                    </div>

                    <div class="field">
                        <label for="day_of_week">
                            <span>Day of Week (0–6)</span>
                            <span class="range-note">0=Monday, 6=Sunday</span>
                        </label>
                        <select id="day_of_week" required>
                            <option value="0">Monday (0)</option>
                            <option value="1">Tuesday (1)</option>
                            <option value="2">Wednesday (2)</option>
                            <option value="3">Thursday (3)</option>
                            <option value="4">Friday (4)</option>
                            <option value="5">Saturday (5)</option>
                            <option value="6">Sunday (6)</option>
                        </select>
                    </div>

                    <div class="field">
                        <label for="is_weekend">
                            <span>Is Weekend?</span>
                            <span class="range-note">0 = No, 1 = Yes</span>
                        </label>
                        <select id="is_weekend" required>
                            <option value="0" selected>Weekday (0)</option>
                            <option value="1">Weekend (1)</option>
                        </select>
                    </div>

                    <div class="field">
                        <label for="voltage_flag">
                            <span>Voltage Flag (0–2)</span>
                            <span class="range-note">0=Low, 1=Normal, 2=High</span>
                        </label>
                        <select id="voltage_flag" required>
                            <option value="0">Low (0)</option>
                            <option value="1" selected>Normal (1)</option>
                            <option value="2">High (2)</option>
                        </select>
                    </div>

                    <div class="field">
                        <label for="pf_issue">
                            <span>Power Factor Issue?</span>
                            <span class="range-note">0 = No, 1 = Yes</span>
                        </label>
                        <select id="pf_issue" required>
                            <option value="0" selected>No (0)</option>
                            <option value="1">Yes (1)</option>
                        </select>
                    </div>

                    <div class="field">
                        <label for="high_temp">
                            <span>High Temperature?</span>
                            <span class="range-note">0 = No, 1 = Yes (&gt;40°C)</span>
                        </label>
                        <select id="high_temp" required>
                            <option value="0" selected>No (0)</option>
                            <option value="1">Yes (1)</option>
                        </select>
                    </div>

                    <div class="field">
                        <label for="load_intensity">
                            <span>Load Intensity</span>
                            <span class="range-note">Ratio (units/load)</span>
                        </label>
                        <input
                            type="number"
                            step="0.01"
                            id="load_intensity"
                            placeholder="e.g. 10.5"
                            value="10.5"
                            min="0"
                            required
                        >
                    </div>
                </div>

                <div class="actions">
                    <button type="submit">Predict</button>
                </div>
            </form>
        </div>

        <!-- Right: Result -->
        <div class="right-column">
            <div id="resultStatus" class="status-pill status-neutral">
                Awaiting input
            </div>

            <div class="result-panel">
                <div class="result-header">Prediction</div>
                <p id="resultText">Fill in the form and click "Predict".</p>
                <p id="probText" class="small-muted">The predicted consumption (kWh) will appear here.</p>
            </div>

            <div class="info-box">
                <strong>About this prediction:</strong><br>
                This model predicts electricity meter consumption (units in kWh) based on electrical parameters
                and temporal features. Results are approximate estimates.
            </div>

            <p class="small-muted">
                Output is based on the trained Linear Regression model.
            </p>
        </div>
    </div>
</div>

<script>
    document.getElementById('predictionForm').addEventListener('submit', async function (e) {
        e.preventDefault();

        const data = {
            voltage: parseFloat(document.getElementById('voltage').value),
            temperature: parseFloat(document.getElementById('temperature').value),
            power_factor: parseFloat(document.getElementById('power_factor').value),
            load_kw: parseFloat(document.getElementById('load_kw').value),
            frequency_hz: parseFloat(document.getElementById('frequency_hz').value),
            hour: parseInt(document.getElementById('hour').value),
            day_of_week: parseInt(document.getElementById('day_of_week').value),
            is_weekend: parseInt(document.getElementById('is_weekend').value),
            voltage_flag: parseInt(document.getElementById('voltage_flag').value),
            pf_issue: parseInt(document.getElementById('pf_issue').value),
            high_temp: parseInt(document.getElementById('high_temp').value),
            load_intensity: parseFloat(document.getElementById('load_intensity').value),
        };

        const resultText   = document.getElementById('resultText');
        const probText     = document.getElementById('probText');
        const resultStatus = document.getElementById('resultStatus');

        resultText.textContent   = 'Running prediction...';
        probText.textContent     = '';
        resultStatus.textContent = 'Predicting…';
        resultStatus.className   = 'status-pill status-neutral';

        try {
            const response = await fetch('/predict', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });

            const result = await response.json();

            if (response.ok) {
                const units = result.prediction;

                resultText.textContent = `Predicted Consumption: ${units} kWh`;

                let statusClass = 'status-neutral';
                let statusText = 'Low consumption';
                if (units > 35) {
                    statusClass = 'status-high';
                    statusText = 'High consumption';
                } else if (units > 25) {
                    statusClass = 'status-warning';
                    statusText = 'Medium consumption';
                } else {
                    statusClass = 'status-good';
                    statusText = 'Low consumption';
                }

                probText.textContent = `Estimated consumption range: ${(units * 0.9).toFixed(1)} – ${(units * 1.1).toFixed(1)} kWh`;
                resultStatus.textContent = statusText;
                resultStatus.className = `status-pill ${statusClass}`;

            } else {
                resultText.textContent = 'Error while predicting.';
                probText.textContent = result.detail || 'Something went wrong on the server.';
                resultStatus.textContent = 'Error';
                resultStatus.className = 'status-pill status-high';
            }
        } catch (err) {
            console.error(err);
            resultText.textContent = 'Network or server error.';
            probText.textContent = 'Check if the FastAPI service is running.';
            resultStatus.textContent = 'Error';
            resultStatus.className = 'status-pill status-high';
        }
    });
</script>

</body>
</html>
